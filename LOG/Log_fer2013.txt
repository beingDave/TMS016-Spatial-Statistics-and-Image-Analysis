CUDA is available!  Training on GPU ...
[SAVED]: Validation acc increased (0.000000 --> 40.206664)

Epoch: 1/100
Training Accuracy: 30.523	Training Loss: 1.720400
Validation Accuracy: 40.207	Validation Loss: 1.526545
[SAVED]: Validation loss decreased (inf --> 1.526545)
[SAVED]: Validation acc increased (40.206664 --> 43.004760)

Epoch: 2/100
Training Accuracy: 40.889	Training Loss: 1.512051
Validation Accuracy: 43.005	Validation Loss: 1.441312
[SAVED]: Validation loss decreased (1.526545 --> 1.441312)
[SAVED]: Validation acc increased (43.004760 --> 47.915941)

Epoch: 3/100
Training Accuracy: 45.392	Training Loss: 1.421455
Validation Accuracy: 47.916	Validation Loss: 1.354436
[SAVED]: Validation loss decreased (1.441312 --> 1.354436)
[SAVED]: Validation acc increased (47.915941 --> 48.194590)

Epoch: 4/100
Training Accuracy: 47.935	Training Loss: 1.354454
Validation Accuracy: 48.195	Validation Loss: 1.351163
[SAVED]: Validation loss decreased (1.354436 --> 1.351163)
[SAVED]: Validation acc increased (48.194590 --> 48.670614)

Epoch: 5/100
Training Accuracy: 50.284	Training Loss: 1.300929
Validation Accuracy: 48.671	Validation Loss: 1.334829
[SAVED]: Validation loss decreased (1.351163 --> 1.334829)
[SAVED]: Validation acc increased (48.670614 --> 51.410658)

Epoch: 6/100
Training Accuracy: 51.752	Training Loss: 1.258003
Validation Accuracy: 51.411	Validation Loss: 1.279981
[SAVED]: Validation loss decreased (1.334829 --> 1.279981)

Epoch: 7/100
Training Accuracy: 53.608	Training Loss: 1.211235
Validation Accuracy: 49.925	Validation Loss: 1.340940
EarlyStopping counter: 1 out of 20

Epoch: 8/100
Training Accuracy: 55.160	Training Loss: 1.176081
Validation Accuracy: 48.113	Validation Loss: 1.476417
EarlyStopping counter: 2 out of 20

Epoch: 9/100
Training Accuracy: 56.489	Training Loss: 1.141435
Validation Accuracy: 50.807	Validation Loss: 1.346202
EarlyStopping counter: 3 out of 20

Epoch: 10/100
Training Accuracy: 58.141	Training Loss: 1.101682
Validation Accuracy: 50.168	Validation Loss: 1.427826
EarlyStopping counter: 4 out of 20

Epoch: 11/100
Training Accuracy: 58.763	Training Loss: 1.078067
Validation Accuracy: 47.417	Validation Loss: 1.526333
EarlyStopping counter: 5 out of 20
[SAVED]: Validation acc increased (51.410658 --> 53.012887)

Epoch: 12/100
Training Accuracy: 60.131	Training Loss: 1.046516
Validation Accuracy: 53.013	Validation Loss: 1.274769
[SAVED]: Validation loss decreased (1.279981 --> 1.274769)

Epoch: 13/100
Training Accuracy: 61.281	Training Loss: 1.014251
Validation Accuracy: 52.699	Validation Loss: 1.311437
EarlyStopping counter: 1 out of 20
[SAVED]: Validation acc increased (53.012887 --> 53.906885)

Epoch: 14/100
Training Accuracy: 62.256	Training Loss: 0.991034
Validation Accuracy: 53.907	Validation Loss: 1.294983
EarlyStopping counter: 2 out of 20

Epoch: 15/100
Training Accuracy: 63.993	Training Loss: 0.961632
Validation Accuracy: 53.884	Validation Loss: 1.290043
EarlyStopping counter: 3 out of 20

Epoch: 16/100
Training Accuracy: 64.117	Training Loss: 0.939671
Validation Accuracy: 51.643	Validation Loss: 1.469796
EarlyStopping counter: 4 out of 20

Epoch: 17/100
Training Accuracy: 65.356	Training Loss: 0.915046
Validation Accuracy: 47.405	Validation Loss: 1.928014
EarlyStopping counter: 5 out of 20

Epoch: 18/100
Training Accuracy: 66.172	Training Loss: 0.897492
Validation Accuracy: 53.384	Validation Loss: 1.366213
EarlyStopping counter: 6 out of 20

Epoch: 19/100
Training Accuracy: 67.133	Training Loss: 0.873458
Validation Accuracy: 50.772	Validation Loss: 1.542419
EarlyStopping counter: 7 out of 20

Epoch: 20/100
Training Accuracy: 67.725	Training Loss: 0.849216
Validation Accuracy: 50.784	Validation Loss: 1.716721
EarlyStopping counter: 8 out of 20

Epoch: 21/100
Training Accuracy: 67.700	Training Loss: 0.845594
Validation Accuracy: 52.432	Validation Loss: 1.458528
EarlyStopping counter: 9 out of 20

Epoch: 22/100
Training Accuracy: 68.456	Training Loss: 0.825516
Validation Accuracy: 51.654	Validation Loss: 1.606603
EarlyStopping counter: 10 out of 20

Epoch: 23/100
Training Accuracy: 69.218	Training Loss: 0.814141
Validation Accuracy: 50.714	Validation Loss: 1.581625
EarlyStopping counter: 11 out of 20

Epoch: 24/100
Training Accuracy: 70.517	Training Loss: 0.785677
Validation Accuracy: 51.178	Validation Loss: 1.665861
EarlyStopping counter: 12 out of 20

Epoch: 25/100
Training Accuracy: 70.999	Training Loss: 0.769502
Validation Accuracy: 52.978	Validation Loss: 1.537628
EarlyStopping counter: 13 out of 20

Epoch: 26/100
Training Accuracy: 71.701	Training Loss: 0.757420
Validation Accuracy: 53.373	Validation Loss: 1.546820
EarlyStopping counter: 14 out of 20

Epoch: 27/100
Training Accuracy: 71.820	Training Loss: 0.752949
Validation Accuracy: 52.398	Validation Loss: 1.621667
EarlyStopping counter: 15 out of 20

Epoch: 28/100
Training Accuracy: 72.626	Training Loss: 0.733267
Validation Accuracy: 53.605	Validation Loss: 1.529225
EarlyStopping counter: 16 out of 20

Epoch: 29/100
Training Accuracy: 73.044	Training Loss: 0.718459
Validation Accuracy: 51.898	Validation Loss: 1.684189
EarlyStopping counter: 17 out of 20

Epoch: 30/100
Training Accuracy: 74.010	Training Loss: 0.696987
Validation Accuracy: 52.816	Validation Loss: 1.543354
EarlyStopping counter: 18 out of 20

Epoch: 31/100
Training Accuracy: 73.602	Training Loss: 0.700255
Validation Accuracy: 51.492	Validation Loss: 1.824209
EarlyStopping counter: 19 out of 20

Epoch: 32/100
Training Accuracy: 74.607	Training Loss: 0.680335
Validation Accuracy: 52.398	Validation Loss: 1.620128
EarlyStopping counter: 20 out of 20
Early stopping
dmodel_fer2013_high_val_acc.pt
Test Loss: 1.004796

Test Accuracy of Angry: 47% (1913/3995)
Test Accuracy of Disgust:  1% ( 6/436)
Test Accuracy of  Fear: 21% (868/4097)
Test Accuracy of Happy: 87% (6348/7215)
Test Accuracy of   Sad: 56% (2744/4830)
Test Accuracy of Surprise: 88% (2791/3171)
Test Accuracy of Neutral: 66% (3325/4965)

Test Accuracy (Overall): 62% (17995/28709)
<Figure size 432x288 with 0 Axes>

------------------------------------------------------------------

dmodel_fer2013_low_val_loss.pt
Test Loss: 1.042235

Test Accuracy of Angry: 46% (1872/3995)
Test Accuracy of Disgust:  0% ( 0/436)
Test Accuracy of  Fear: 17% (718/4097)
Test Accuracy of Happy: 83% (6047/7215)
Test Accuracy of   Sad: 50% (2457/4830)
Test Accuracy of Surprise: 87% (2782/3171)
Test Accuracy of Neutral: 70% (3519/4965)

Test Accuracy (Overall): 60% (17395/28709)
<Figure size 432x288 with 0 Axes>

----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1           [-1, 16, 36, 36]             160
       BatchNorm2d-2           [-1, 16, 36, 36]              32
            Conv2d-3           [-1, 32, 18, 18]           4,640
       BatchNorm2d-4           [-1, 32, 18, 18]              64
            Conv2d-5             [-1, 64, 9, 9]          18,496
       BatchNorm2d-6             [-1, 64, 9, 9]             128
            Conv2d-7             [-1, 64, 4, 4]          36,928
       BatchNorm2d-8             [-1, 64, 4, 4]             128
           Dropout-9                  [-1, 256]               0
           Linear-10                  [-1, 256]          65,792
          Dropout-11                  [-1, 256]               0
           Linear-12                    [-1, 7]           1,799
================================================================
Total params: 128,167
Trainable params: 128,167
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.00
Forward/backward pass size (MB): 0.58
Params size (MB): 0.49
Estimated Total Size (MB): 1.07
----------------------------------------------------------------

Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.001
)

MNetwork(
  (conv1): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv3): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv4): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (BN1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (BN2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (BN3): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (BN4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=256, out_features=256, bias=True)
  (out): Linear(in_features=256, out_features=7, bias=True)
  (dropout): Dropout(p=0.5, inplace=False)
)